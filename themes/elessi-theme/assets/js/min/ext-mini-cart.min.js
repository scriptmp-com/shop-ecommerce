jQuery(document).ready(function(a){"use strict";var e,n=function(a){return a.is(".processing")||a.parents(".processing").length},t=function(e){if(a("body").trigger("nasa_publish_coupon_refresh"),!n(e)){var t=a("body").hasClass("nasa-dark")?"#000":"#fff";e.addClass("processing").block({message:null,overlayCSS:{background:t,opacity:.6}})}},o=function(e){e.removeClass("processing").unblock(),e.find(".nasa-close-node").length&&e.find(".nasa-close-node").trigger("click"),a("body").trigger("nasa_publish_coupon_refresh")},s=function(a){return ext_mini_cart_params.wc_ajax_url.toString().replace("%%endpoint%%",a)},i=function(n){a(".ext-mini-cart-wrap .mess-wrap").remove(),a(".ext-mini-cart-wrap").append('<div class="mess-wrap">'+n+"</div>"),e&&clearTimeout(e),e=setTimeout(function(){a(".ext-mini-cart-wrap .mess-wrap").remove()},5e3)};a("body").on("nasa_opened_cart_sidebar",function(){a("body").hasClass("canvas-on")||a("body").addClass("canvas-on"),a("body").trigger("nasa_load_ext_mini_cart")}),a("body").on("nasa_after_close_fog_window",function(){a("body").removeClass("canvas-on")}),a("body").on("click",".nasa-close-node",function(){var e=a(this).parents(".nasa-static-sidebar"),n=a(this).parents(".ext-node");a(e).length&&a(e).removeClass("ext-loading"),a(n).length&&a(n).removeClass("active"),a(e).find(".ext-nodes-wrap .close-nodes").remove()}),a("body").on("click",".ext-nodes-wrap .close-nodes",function(){var e=a(this).parents(".ext-nodes-wrap"),n=a(e).find(".ext-node.active .nasa-close-node");a(n).length&&a(n).trigger("click")}),a("body").on("click",".ext-mini-cart",function(){var e=a(this).attr("data-act"),n=a(this).parents(".nasa-static-sidebar");a(n).find(".ext-mini-cart-wrap").length&&!a(n).find(".ext-mini-cart-wrap").hasClass("nasa-disable")&&(a("body").hasClass("canvas-on")||a("body").addClass("canvas-on"),a(n).hasClass("ext-loading")||a(n).addClass("ext-loading"),a(n).find(".ext-nodes-wrap").length<1&&a(n).append('<div class="ext-nodes-wrap"></div>'),a(n).find(".ext-nodes-wrap .close-nodes").length<1&&a(n).find(".ext-nodes-wrap").prepend('<a href="javascript:void(0);" class="close-nodes"></a>'),a(n).find(".ext-nodes-wrap .ext-node").removeClass("active"),a(n).find(".ext-nodes-wrap .ext-node.mini-cart-"+e).length?a(n).find(".ext-nodes-wrap .ext-node.mini-cart-"+e).addClass("active"):a.ajax({url:s("nasa_ext_mini_cart"),type:"post",dataType:"json",cache:!1,data:{act:e},success:function(t){"undefined"!=typeof t.content&&(a(n).find(".ext-nodes-wrap").append(t.content),"shipping"===e&&setTimeout(function(){a(n).find("select.country_to_state, input.country_to_state").trigger("change"),a(document.body).trigger("country_to_state_changed")},100),setTimeout(function(){a(n).find(".ext-nodes-wrap .ext-node.mini-cart-"+e).length&&a(n).find(".ext-nodes-wrap .ext-node.mini-cart-"+e).addClass("active")},300))},error:function(){a(n).removeClass("ext-loading")}}))}),a("body").on("nasa_load_ext_mini_cart",function(){var e=a("#cart-sidebar");a("body").hasClass("canvas-on")||a("body").addClass("canvas-on"),a(e).find(".ext-nodes-wrap").length<1&&a(e).append('<div class="ext-nodes-wrap"></div>'),a(e).find(".ext-nodes-wrap .ext-node").length<1&&a.ajax({url:s("nasa_all_ext_mini_cart"),type:"post",dataType:"json",cache:!1,data:{},beforeSend:function(){a(".ext-mini-cart-wrap").length&&a(".ext-mini-cart-wrap").addClass("nasa-disable")},success:function(n){"undefined"!=typeof n.content&&(a(e).find(".ext-nodes-wrap").append(n.content),a(e).find("select.country_to_state, input.country_to_state").length&&setTimeout(function(){a(e).find("select.country_to_state, input.country_to_state").trigger("change"),a(document.body).trigger("country_to_state_changed")},100),a("body").trigger("nasa_publish_coupon_refresh")),a(".ext-mini-cart-wrap").length&&a(".ext-mini-cart-wrap").removeClass("nasa-disable")}})}),a("body").on("click","#mini-cart-save_note",function(e){e.preventDefault();var n=a(this);if(!a(n).hasClass("nasa-disable")){a(n).addClass("nasa-disable");var r=a(n).parents(".nasa-static-sidebar");a(r).length<1&&(r=a(n).parents(".widget_shopping_cart_content"));var c=a('.mini-cart-note textarea[name="order_comments"]').val();t(r),a.ajax({url:s("nasa_mini_cart_note"),type:"post",dataType:"json",cache:!1,data:{order_comments:c},success:function(e){a(".woocommerce-error, .woocommerce-message, .woocommerce-info").remove(),a(n).removeClass("nasa-disable"),e&&(e.fragments&&(a.each(e.fragments,function(e,n){a(e).length&&a(e).replaceWith(n)}),a("body").trigger("added_to_cart",[e.fragments,e.cart_hash,!1,!1]),a("body").trigger("wc_fragments_refreshed"),a("body").trigger("nasa_init_shipping_free_notification")),e.mess&&i(e.mess)),o(r)},complete:function(){o(r)}})}}),a("body").on("nasa_publish_coupon_refresh",function(){a(".mini-cart-coupon .publish-coupon").length&&a(".mini-cart-coupon .publish-coupon").each(function(){var e=a(this),n=a(e).attr("data-code");a(e).removeClass("nasa-actived"),a('.coupon-wrap[data-code="'+n+'"]').length&&a(e).addClass("nasa-actived")})}),a("body").on("click",".mini-cart-coupon .publish-coupon:not(.nasa-actived)",function(){var e=this,n=a(e).attr("data-code");a("#mini-cart-add-coupon_code").length&&(a("#mini-cart-add-coupon_code").val(n).trigger("change"),a("#mini-cart-apply_coupon").length&&a("#mini-cart-apply_coupon").trigger("click"))}),a("body").on("click","#mini-cart-apply_coupon",function(e){e.preventDefault();var n=a(this),r=a(".mini-cart-ajax-nonce input[name=apply_coupon_nonce]").length?a(".mini-cart-ajax-nonce input[name=apply_coupon_nonce]").val():null;if(r&&!a(n).hasClass("nasa-disable")){a(n).addClass("nasa-disable");var c=a(n).parents(".nasa-static-sidebar");a(c).length<1&&(c=a(n).parents(".widget_shopping_cart_content"));var d=a("input#mini-cart-add-coupon_code").val();if(d){t(c);var p={security:r,coupon_code:d};a.ajax({type:"POST",url:s("nasa_mini_cart_apply_coupon"),data:p,dataType:"json",success:function(e){a(".woocommerce-error, .woocommerce-message, .woocommerce-info").remove(),a(n).removeClass("nasa-disable"),e&&(e.fragments&&(a.each(e.fragments,function(e,n){a(e).length&&a(e).replaceWith(n)}),a("body").trigger("added_to_cart",[e.fragments,e.cart_hash,n,!1]),a("body").trigger("wc_fragments_refreshed"),a("body").trigger("nasa_init_shipping_free_notification")),e.mess&&i(e.mess),a("input#mini-cart-add-coupon_code").val("").trigger("change")),o(c)},complete:function(){o(c)}})}else a(n).removeClass("nasa-disable")}}),a("body").on("click",".widget_shopping_cart_content .woocommerce-remove-coupon",function(e){e.preventDefault();var n=a(this),r=a(".mini-cart-ajax-nonce input[name=remove_coupon_nonce]").length?a(".mini-cart-ajax-nonce input[name=remove_coupon_nonce]").val():null;if(r&&!a(n).hasClass("nasa-disable")){a(n).addClass("nasa-disable");var c=a(n).parents(".nasa-static-sidebar");a(c).length<1&&(c=a(n).parents(".widget_shopping_cart_content")),t(c);var d=a(n).attr("data-coupon"),p={security:r,coupon:d};a.ajax({type:"POST",url:s("nasa_mini_cart_remove_coupon"),data:p,dataType:"json",success:function(e){a(".woocommerce-error, .woocommerce-message, .woocommerce-info").remove(),a(n).removeClass("nasa-disable"),e&&(e.fragments&&(a.each(e.fragments,function(e,n){a(e).length&&a(e).replaceWith(n)}),a("body").trigger("added_to_cart",[e.fragments,e.cart_hash,!1,!1]),a("body").trigger("wc_fragments_refreshed"),a("body").trigger("nasa_init_shipping_free_notification")),e.mess&&i(e.mess)),o(c)},complete:function(){o(c)}})}}),a("body").on("click",'.mini-cart-shipping [name="calc_shipping"]',function(e){e.preventDefault();var n=a(this);if(!a(n).hasClass("nasa-disable")){a(n).addClass("nasa-disable");var r=a(n).parents(".ext-node"),c=a(n).parents("form");t(r),a("<input />").attr("type","hidden").attr("name","calc_shipping").attr("value","x").appendTo(c);var d=c.serialize();a.ajax({type:"POST",url:s("nasa_mini_cart_calculate_shipping"),data:d,dataType:"json",success:function(e){a(".woocommerce-error, .woocommerce-message, .woocommerce-info").remove(),a(n).removeClass("nasa-disable"),e&&(e.fragments&&(a.each(e.fragments,function(e,n){a(e).length&&a(e).replaceWith(n)}),a("body").trigger("added_to_cart",[e.fragments,e.cart_hash,n,!1]),a("body").trigger("wc_fragments_refreshed"),a("body").trigger("nasa_init_shipping_free_notification")),e.mess&&i(e.mess)),o(r)},complete:function(){o(r)}})}})});